<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ูุนุจุฉ ุงูุฏูุฏุฉ - Low current</title>
<style>
body { background:#ccf2ff; font-family:Tahoma; margin:0; overflow:hidden; display:flex; justify-content:center; align-items:flex-start; height:100vh; }
#container { display:flex; margin-top:20px; }
#sidebar-left { width:220px; max-height:90vh; overflow-y:auto; background:#f0f8ff; padding:10px; margin-right:10px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.2); }
#sidebar-left h4 { text-align:center; }
.answered { margin-bottom:6px; padding:4px 6px; background:#d1ffd1; border-radius:4px; }
#maze-wrapper { position:relative; }
#header { text-align:center; font-weight:bold; font-size:18px; margin-bottom:10px; }
#sidebar-right { width:180px; padding:10px; background:#fff0f5; margin-left:10px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.2); text-align:center; }
#maze { position:relative; width:500px; height:500px; background:#fff; border:6px solid #2b6fb3; border-radius:12px; }
.snake-segment { position:absolute; width:20px; height:20px; background:#4CAF50; border-radius:50%; border:2px solid #2E7D32; z-index:10; transition: all 0.05s linear; display:flex; align-items:center; justify-content:center; font-size:11px; font-weight:bold; color:white; }
.snake-head { background:#FF5722; border-color:#D84315; }
.q-node { position:absolute; width:50px; height:50px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; font-weight:bold; z-index:5; color:white; font-size:18px; }
#questionBox { position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:20px; border-radius:12px; box-shadow:0 0 20px rgba(0,0,0,0.3); width:350px; display:none; z-index:20; }
#questionBox h3 { font-size:16px; margin-bottom:12px; }
.choice { background:#ddd; padding:10px; margin:8px; border-radius:8px; cursor:pointer; font-size:14px; }
.choice:hover { background:#bbb; }
#winScreen { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,200,0,0.9); color:white; font-size:32px; display:flex; justify-content:center; align-items:center; flex-direction:column; display:none; }
#snakeLength { font-size:16px; font-weight:bold; color:#4CAF50; margin-top:10px; }

/* ุชูุณูู ุงูููุจุงูู */
@media only screen and (max-width: 768px) {
  body { align-items:center; }
  #container { flex-direction:column; align-items:center; margin-top:5px; width:100%; padding:5px; box-sizing:border-box; }
  #sidebar-left { width:95%; max-width:none; margin:0 0 10px 0; max-height:120px; font-size:13px; order:1; }
  #maze-wrapper { order:2; width:100%; display:flex; flex-direction:column; align-items:center; }
  #header { font-size:14px; padding:5px; margin-bottom:5px; }
  #maze { width:95vmin; height:95vmin; max-width:500px; max-height:500px; border:4px solid #2b6fb3; }
  .snake-segment { width:18px; height:18px; font-size:10px; border-width:2px; }
  .q-node { width:32px; height:32px; font-size:14px; }
  #sidebar-right { width:95%; max-width:none; margin:10px 0 0 0; font-size:15px; order:3; padding:8px; }
  #questionBox { width:90%; max-width:500px; padding:20px; }
  #questionBox h3 { font-size:18px; margin-bottom:15px; line-height:1.5; }
  .choice { padding:14px 12px; margin:10px 0; font-size:16px; border-radius:10px; line-height:1.4; }
  #winScreen { font-size:24px; padding:20px; text-align:center; }
  .answered { font-size:12px; padding:5px 6px; line-height:1.3; }
  #sidebar-left h4, #sidebar-right h4 { font-size:14px; margin:5px 0; }
}
</style>
</style>
</head>
<body>
<div id="container">
  <div id="sidebar-left">
    <h4>ุงูุฅุฌุงุจุงุช</h4>
    <div id="answeredList"></div>
  </div>

  <div id="maze-wrapper">
    <div id="header">ุงููุฑุฌุน ูู ุฃูุธูุฉ ุงูุชูุงุฑ ุงูุฎููู|ุงููุตู ุงูุฑุงุจุน SMATV systems 1</div>
    <div id="maze" id="maze"></div>
  </div>

  <div id="sidebar-right">
    <h4>ูุนูููุงุช ุงูุฌููุฉ</h4>
    <p id="roundInfo">ุงูุฌููุฉ: 1</p>
    <p id="questionInfo">ุงูุณุคุงู: 0 / 0</p>
    <p id="snakeLength">ุทูู ุงูุฏูุฏุฉ: 3</p>
  </div>
</div>

<div id="questionBox">
  <h3 id="qText"></h3>
  <div id="choices"></div>
</div>

<div id="winScreen">
  ๐ ูุจุฑูู! ุฃูููุช ุฌููุน ุงูุฃุณุฆูุฉ! ๐
  <audio id="winSound" src="../media/win.mp3"></audio>
</div>

<script>
// ********** ุงูุฃุณุฆูุฉ **********
const allQuestions = [
    // --- ุชุงุฑูุฎ ุงูุชููุฒููู ูููููุงุชู (ุต 78) ---
    {
        q: "ูู ูู ุงููููุฏุณ ุงูุฃููุงูู ุงูุฐู ุงุฎุชุฑุน ุฌูุงุฒ ุงูุชููุฒููู ุงููููุงูููู ูู ุนุงู 1884 ูุงูุฐู ูุนุชูุฏ ุนูู ูุฑุต ูููุจู (Nipkow)ุ",
        c: ["ุฌูู ููุฌู ุจูุฑุฏ", "ุจูู ูููุจู", "ุฌูุฒูู ููุฑู", "ูู ุฏู ููุฑูุณุช"],
        a: 1 // ุจูู ูููุจู
    },
    {
        q: "ูุง ูู ุงููุจุฏุฃ ุงูุฃุณุงุณู ุงูุฐู ุงุนุชูุฏ ุนููู ุงูุชููุฒููู ุงููููุงูููู ูู ููู ุงูุตูุฑ ุงููุชุญุฑูุฉุ",
        c: ["ุชุญููู ุงูุตูุฑุฉ ุฅูู ุฃุฌุฒุงุก ุตุบูุฑุฉ", "ุงุณุชุฎุฏุงู ุงูุฃููุงุฑ ุงูุตูุงุนูุฉ", "ููู ุงูุตูุฑุฉ ุจุงููุงูู ุฏูุนุฉ ูุงุญุฏุฉ", "ุชุญููู ุงูุตูุช ุฅูู ุฅุดุงุฑุงุช ุถูุฆูุฉ"],
        a: 0 // ุชุญููู ุงูุตูุฑุฉ ุฅูู ุฃุฌุฒุงุก ุตุบูุฑุฉ
    },
    {
        q: "ูุชู ุจุฏุฃ ุฃูู ุจุซ ุชููุฒูููู ูู ุงูุนุงูู ุจุงุณุชุฎุฏุงู ุฃุฌูุฒุฉ ุฌูู ููุฌู ุจูุฑุฏ (J.L. Baird)ุ",
        c: ["ุนุงู 1936", "ุนุงู 1927", "ุนุงู 1954", "ุนุงู 1884"],
        a: 1 // ูู 7 ููููู 1927 (ูู DC, Washington)
    },
    {
        q: "ูุง ูู ุงูููุฆุฉ ุงููุณุคููุฉ ุนู ุฃูู ุจุซ ุชููุฒูููู ูู ุงูุนุงูู ุจุงุณุชุฎุฏุงู ุฃุฌูุฒุฉ ุฌูู ููุฌู ุจูุฑุฏุ",
        c: ["ููุฆุฉ ุงูุฅุฐุงุนุฉ ุงููุงุจุงููุฉ (NHK)", "ููุฆุฉ ุงูุฅุฐุงุนุฉ ุงูุจุฑูุทุงููุฉ (BBC)", "ููุฆุฉ ุงูุฅุฐุงุนุฉ ุงูุฃูุฑูููุฉ (ABC)", "ููุฆุฉ ุงูุฅุฐุงุนุฉ ุงููุฑูุณูุฉ"],
        a: 1 // ููุฆุฉ ุงูุฅุฐุงุนุฉ ุงูุจุฑูุทุงููุฉ (BBC)
    },
    {
        q: "ูุชู ุชู ุชุฃุณูุณ ุงูุชููุฒููู ุงูุนุฑุงูู ูุฃูู ูุฑุฉ ูุฅุฑุณุงู ุชููุฒูููู ุชุฌุฑูุจูุ",
        c: ["ุนุงู 1956", "ุนุงู 1957", "ุนุงู 1954", "ุนุงู 1960"],
        a: 2 // ุนุงู 1954
    },
    {
        q: "ูุชู ุชู ูุถุน ุงูุญุฌุฑ ุงูุฃุณุงุณ ูุฅูุดุงุก ุงูุชููุฒููู ุงูุฑุณูู ูู ุงูุนุฑุงูุ",
        c: ["ุนุงู 1954", "ุนุงู 1956", "ุนุงู 1957", "ุนุงู 1960"],
        a: 2 // ูู ุดูุฑ ุฏูุณูุจุฑ 1956 ูุชู ุงูุชุชุงุญู ูู 27/9/1957.
    },
    {
        q: "ูุชู ุจุฏุฃ ุงูุจุซ ุงูุชููุฒูููู ูู ูุตุฑ ูุฃูู ูุฑุฉุ",
        c: ["ุนุงู 1957", "ุนุงู 1960", "ุนุงู 1954", "ุนุงู 1967"],
        a: 1 // ุณูุฉ 1960
    },
    {
        q: "ูุง ูู ุงููุฑุงุญู ุงูุฑุฆูุณูุฉ ูุชุญููู ุงูุตูุฑุฉ ุฅูู ุฅุดุงุฑุฉ ููุฑุจุงุฆูุฉ ูู ุฌูุงุฒ ุงูุฅุฑุณุงู ุงูุชููุฒููููุ",
        c: ["ุชุณุฌูู ุงูุตูุชุ ุชุนุฏูู ุงูุชุฑุฏุฏุ ุงูุฅุฑุณุงู", "ุชุณุฌูู ุงูุตูุฑุฉุ ุฅุฑุณุงู ุงูุตูุฑ ุงูุซุงุจุชุฉุ ุงูุจุซ", "ุชุญููู ุงูุตูุฑุฉุ ุชุญููู ุงูุตูุช ุฅูู ุฅุดุงุฑุงุช ููุฑุจุงุฆูุฉุ ุฏูุฌ ุงูุฅุดุงุฑุงุช", "ุงุณุชูุจุงู ุงูุตูุฑุฉุ ุชูุจูุฑ ุงูุฅุดุงุฑุฉุ ุนุฑุถ ุงูุตูุฑุฉ"],
        a: 2 // ุชุญููู ุงูุตูุฑุฉุ ุชุญููู ุงูุตูุช ุฅูู ุฅุดุงุฑุงุช ููุฑุจุงุฆูุฉุ ุฏูุฌ ุงูุฅุดุงุฑุงุช
    },
    {
        q: "ูุง ูู ุงูุฅุฌุฑุงุก ุงูุฐู ูููู ุจู ุฌูุงุฒ ุงูุงุณุชูุจุงู ุงูุชููุฒูููู ูุงุณุชุนุงุฏุฉ ุงูุฅุดุงุฑุงุช ุงูููุฑุจุงุฆูุฉ ุฅูู ุญุงูุชูุง ุงูุฃุตููุฉ (ุต 77)ุ",
        c: ["ุชุนุฏูู ุงูุชุฑุฏุฏ (Frequency Modulation)", "ูุถุงุนูุฉ ุงูุฅุดุงุฑุฉ (Multiplexing)", "ุงุณุชุฑุฌุงุน ุงูุฅุดุงุฑุงุช ุงูููุฑุจุงุฆูุฉ", "ููููุง ุจุงูุชุฑุฏุฏุงุช ุงูุฑุงุฏูููุฉ (RF)"],
        a: 2 // ูููู ุฌูุงุฒ ุงูุงุณุชูุจุงู ุจุงุณุชุฑุฌุงุน ุงูุฅุดุงุฑุงุช ุงูููุฑุจุงุฆูุฉ ุฅูู ุญุงูุชูุง ุงูุฃุตููุฉ
    },
    {
        q: "ูุง ูู ููุน ุงูููุฌุงุช ุงูููุฑููุบูุงุทูุณูุฉ ุงูุชู ุชุณุชุฎุฏู ูู ููู ุงูุฅุดุงุฑุงุช ุงูุชููุฒููููุฉ ูุงูุฃุฑุถูุฉุ",
        c: ["ุงูุฃุดุนุฉ ุงูุณูููุฉ", "ุงูุชุฑุฏุฏุงุช ุงูุฑุงุฏูููุฉ (Radio Frequency)", "ููุฌุงุช ุงูุถูุก ุงููุฑุฆู", "ุงูุฃุดุนุฉ ุชุญุช ุงูุญูุฑุงุก"],
        a: 1 // ุงูุชุฑุฏุฏุงุช ุงูุฑุงุฏูููุฉ (Radio Frequency)
    },
    {
        q: "ูุง ูู ูุทุงูุงุช ุงูุชุฑุฏุฏ ุงูุฑุงุฏููู (RF) ุงูุดุงุฆุนุฉ ุงููุณุชุฎุฏูุฉ ูู ุงูุจุซ ุงูุชููุฒูููู (ุต 78)ุ",
        c: ["VLF, LF, MF", "ELF, SLF, ULF", "VHF, UHF, SHF", "MW, SW, LW"],
        a: 2 // VHF, UHF, SHF
    },
    // --- ุชุงุฑูุฎ ุงูุฑุงุฏูู ูุงูููุฌุงุช (ุต 76) ---
    {
        q: "ูู ูู ููุชุดู ุฅููุงููุฉ ุงูุชูุงู ุงูุตูุช ุนุจุฑ ุงูุฃุซูุฑ ูู ุงูุฑุจุน ุงูุฃุฎูุฑ ูู ุงููุฑู ุงูุชุงุณุน ุนุดุฑ ุงููููุงุฏูุ",
        c: ["ุฃููุณูุฏุฑ ุบุฑุงูุงู ุจูู", "ุฌููููููู ูุงุฑูููู", "ุชููุงุณ ุฅุฏูุณูู", "ุฌูุฒูู ููุฑู"],
        a: 1 // ุฌููููููู ูุงุฑูููู (ุนุงู 1865)
    },
    {
        q: "ูุง ูู ุงููุตุทูุญ ุงูุฐู ูุตู ุนูููุฉ ุฏูุฌ ููุฌุงุช ุงูุฑุงุฏูู ุงูุญุงููุฉ ุฐุงุช ุงูุชุฑุฏุฏ ุงูุนุงูู ูุน ุงูุฅุดุงุฑุฉ ุงูุตูุชูุฉ ุฐุงุช ุงูุชุฑุฏุฏ ุงูููุฎูุถุ",
        c: ["ุงูุชูุทูุฑ", "ุงูุชุญููู", "ุงูุชุดููุฑ", "ุงูุชุถููู"],
        a: 3 // ุงูุชุถููู (Modulation)
    },
    {
        q: "ูุงุฐุง ูุนูู ุงูุฑูุฒ AM ูู ุงูุจุซ ุงูุฅุฐุงุนูุ",
        c: ["ุงูุชุถููู ุงูุณุนูู (Amplitude Modulation)", "ุงูุชุนุฏูู ุงูุณุนูู", "ุงูุชุถููู ุงูุฒุงูู", "ุงูุชุถููู ุงูุชุฑุฏุฏู"],
        a: 0 // ุงูุชุถููู ุงูุณุนูู (Amplitude Modulation)
    },
    {
        q: "ูุงุฐุง ูุนูู ุงูุฑูุฒ FM ูู ุงูุจุซ ุงูุฅุฐุงุนูุ",
        c: ["ุงูุชุถููู ุงูุณุนูู (Amplitude Modulation)", "ุชุถููู ุงูุณุนุฉ", "ุงูุชุถููู ุงูุชุฑุฏุฏู (Frequency Modulation)", "ุชุถููู ุงูุทูุฑ"],
        a: 2 // ุงูุชุถููู ุงูุชุฑุฏุฏู (Frequency Modulation)
    },
    {
        q: "ูุง ูู ูุทุงู ุงูุชุฑุฏุฏ ุงูุฐู ูุนูู ููู ุงูุจุซ ุงูุฅุฐุงุนู (AM) ุงูููุงุณูุ",
        c: ["500 ูููู ูุฑุชุฒ ุฅูู 1600 ูููู ูุฑุชุฒ", "88 ููุบุง ูุฑุชุฒ ุฅูู 108 ููุบุง ูุฑุชุฒ", "10 ูููู ูุฑุชุฒ ุฅูู 200 ูููู ูุฑุชุฒ", "1 ููุบุง ูุฑุชุฒ ุฅูู 10 ููุบุง ูุฑุชุฒ"],
        a: 0 // ูู 500 ุฅูู 1600 ูููู ูุฑุชุฒ
    },
    {
        q: "ูุง ูู ูุทุงู ุงูุชุฑุฏุฏ ุงูุฐู ูุนูู ููู ุงูุจุซ ุงูุฅุฐุงุนู (FM)ุ",
        c: ["500 ูููู ูุฑุชุฒ ุฅูู 1600 ูููู ูุฑุชุฒ", "88 ููุบุง ูุฑุชุฒ ุฅูู 108 ููุบุง ูุฑุชุฒ", "10 ูููู ูุฑุชุฒ ุฅูู 200 ูููู ูุฑุชุฒ", "1 ููุบุง ูุฑุชุฒ ุฅูู 10 ููุบุง ูุฑุชุฒ"],
        a: 1 // ูู 88 ุฅูู 108 ููุบุง ูุฑุชุฒ
    },
    {
        q: "ูุง ูู ุงูุนุฑุถ ุงูุชูุฑูุจู ูููุทุงู ุงูุชุฑุฏุฏู (Bandwidth) ูููุงุฉ FM ูุงุญุฏุฉุ",
        c: ["10 ูููู ูุฑุชุฒ", "200 ูููู ูุฑุชุฒ", "1 ููุบุง ูุฑุชุฒ", "5 ููุบุง ูุฑุชุฒ"],
        a: 1 // 200 ูููู ูุฑุชุฒ
    },
    // --- ุฃูุธูุฉ ุงูู SMATV (ุต 75) ---
    {
        q: "ูุง ูู ุงูุงุฎุชุตุงุฑ ุงูุฐู ููุซูู ูุธุงู SMATVุ",
        c: ["Systemic Mass Access TV", "Satellite Master Antenna TV", "Signal Management and Transmission Vehicle", "Satellite Modern Amplifier Transceiver"],
        a: 1 // Satellite Master Antenna TV
    },
    {
        q: "ูุง ูู ุงููุธููุฉ ุงูุฃุณุงุณูุฉ ููุธุงู SMATV ูู ุงููุจุงูู ุงูุณูููุฉ ุฃู ุงูููุงุฏูุ",
        c: ["ุจุซ ูููุงุช ุฑุงุฏูู AM ููุท", "ุชูุฒูุน ูุนูููุงุช ุงูููุฑุจุงุก ูุงูุฅูุงุฑุฉ", "ุชูุฒูุน ุงูุจุซ ุงูุชููุฒูููู ุนุจุฑ ุงูุฃููุงุฑ ุงูุตูุงุนูุฉ ู/ุฃู ุงูุฃุฑุถู", "ุชูุธูู ุญุฑูุฉ ุงููุฑูุฑ ุงูุฏุงุฎููุฉ"],
        a: 2 // ุชูุฒูุน ุงูุจุซ ุงูุชููุฒูููู ุนุจุฑ ุงูุฃููุงุฑ ุงูุตูุงุนูุฉ ู/ุฃู ุงูุฃุฑุถู
    },
    {
        q: "ูุง ูู ุชุนุฑูู ููุฌุงุช ุงูุฑุงุฏููุ",
        c: ["ููุฌุงุช ุตูุชูุฉ ูููุงููููุฉ", "ููุน ูู ุงูููุฌุงุช ุงูููุฑููุบูุงุทูุณูุฉ ุงููุฌูุฑูุฉ", "ููุฌุงุช ุถูุฆูุฉ ูุฑุฆูุฉ", "ููุฌุงุช ุญุฑุงุฑูุฉ ููุท"],
        a: 1 // ููุน ูู ุงูููุฌุงุช ุงูููุฑููุบูุงุทูุณูุฉ ุงููุฌูุฑูุฉ
    },
    {
        q: "ูุง ูู ุนูุงูุฉ ููุฌุงุช ุงูุฑุงุฏูู ุจุงูููุฑููุบูุงุทูุณูุฉุ",
        c: ["ูุง ุนูุงูุฉ ููุง ุจูุง", "ูู ููุน ูู ุงูููุฌุงุช ุงูููุฑููุบูุงุทูุณูุฉ", "ูู ุนูุณ ุงูููุฌุงุช ุงูููุฑููุบูุงุทูุณูุฉ", "ูู ุงูุชู ุชููุฏ ุงูููุฌุงุช ุงูููุฑููุบูุงุทูุณูุฉ"],
        a: 1 // ูู ููุน ูู ุงูููุฌุงุช ุงูููุฑููุบูุงุทูุณูุฉ
    },
    {
        q: "ูุง ูู ุณุฑุนุฉ ุงูุชูุงู ุงูููุฌุงุช ุงูููุฑููุบูุงุทูุณูุฉ ูู ุงููุฑุงุบุ",
        c: ["ุณุฑุนุฉ ุงูุตูุช", "ุฃุจุทุฃ ูู ุณุฑุนุฉ ุงูุตูุช", "ุณุฑุนุฉ ุงูุถูุก", "ุถุนู ุณุฑุนุฉ ุงูุถูุก"],
        a: 2 // ุณุฑุนุฉ ุงูุถูุก
    },
    {
        q: "ูุง ูู ุงููุฏู ุงูุชูุฑูุจู ูุชุฑุฏุฏุงุช ููุฌุงุช ุงูุฑุงุฏููุ",
        c: ["ูู 30 ูุฑุชุฒ ุฅูู 300 ููุบุงูุฑุชุฒ", "ูู 30 ูุฑุชุฒ ุฅูู 300 ุบูุบุงูุฑุชุฒ", "ูู 30 ูููู ูุฑุชุฒ ุฅูู 300 ูููู ูุฑุชุฒ", "ูู 30 ุบูุบุงูุฑุชุฒ ุฅูู 300 ุบูุบุงูุฑุชุฒ"],
        a: 1 // ูู 30 ูุฑุชุฒ ุฅูู 300 ุบูุบุงูุฑุชุฒ
    },
    {
        q: "ูุง ูู ุงููุตุทูุญ ุงูุฐู ูุตู ุงุณุชุฎุฏุงู ุฌูุงุฒ ุงูุฅุฑุณุงู ุงูุฑุงุฏููู ูููู ุงูููุฌุงุช ุงูููุฑููุบูุงุทูุณูุฉ ุนุจุฑ ุงูููุงุฆูุ",
        c: ["ุงูุฅุดุนุงุน", "ุงูุงุณุชูุจุงู", "ุงูุชุญููู", "ุงูุชุตููุฑ"],
        a: 0 // ุฅุดุนุงุน
    },
    {
        q: "ููุงุฐุง ูุง ูููู ุงุณุชุฎุฏุงู ุงูุชุฑุฏุฏุงุช ุงูุทูููุฉ (Long Waves) ูู ุงูุงุชุตุงูุงุช ุงูุจุนูุฏุฉุ",
        c: ["ูุฃููุง ุถุนููุฉ ุงูุฅุดุงุฑุฉ", "ูุฃููุง ุชุญุชุงุฌ ุฅูู ุทุงูุฉ ูุจูุฑุฉ", "ูุฃููุง ุชููุณุฑ ุนูุฏ ุงูุบูุงู ุงูุฌูู", "ูุฃููุง ุชุนุงูู ูู ุงูุนูุงุฆู ูุซู ุงูุฌุจุงู ูุณุทุญ ุงูุฃุฑุถ ูุชุชุฌู ูุฎุท ุงูุฃูู (Line of Sight)"],
        a: 3 // ุชุนุงูู ูู ุงูุนูุงุฆู ูุซู ุงูุฌุจุงู ูุณุทุญ ุงูุฃุฑุถ ูุชุชุฌู ูุฎุท ุงูุฃูู
    },
    {
        q: "ูุง ูู ุทุฑููุฉ ุงูุชูุงู ุงูููุฌุงุช ุงููุตูุฑุฉ (Short Waves) ุงูุชู ุชุณูุญ ุจุงููุตูู ููุณุงูุงุช ุจุนูุฏุฉ ุญูู ุงูุนุงููุ",
        c: ["ุงูุงุชุตุงู ุงูุฃุฑุถู", "ุงูุงูุนูุงุณ ุนู ุทุจูุฉ ุงูุฃููููุณููุฑ", "ุฎุท ุงูุจุตุฑ ุงููุจุงุดุฑ (Line of Sight)", "ุงูุงูุชูุงู ุนุจุฑ ุงูุฃููุงู ุงูุจุตุฑูุฉ"],
        a: 1 // ุงูุงูุนูุงุณ ุนู ุทุจูุฉ ุงูุฃููููุณููุฑ (ุงูุบูุงู ุงูุฃูููู)
    },
    {
        q: "ูุง ูู ุทุฑููุฉ ุงูุชูุงู ููุฌุงุช ุงููููุฑูููู (Microwaves)ุ",
        c: ["ุงูุงูุนูุงุณ ุนู ุทุจูุฉ ุงูุฃููููุณููุฑ", "ุงูุงุชุตุงู ุงูุฃุฑุถู", "ุงูุงูุชูุงู ุนูู ุทูู ุฎุท ุงูุจุตุฑ (Line of Sight) ูุชูุชุตุฑ ุนูู ูุณุงูุงุช ูุตูุฑุฉ", "ุงูุงูุชูุงู ุนุจุฑ ุงููุญูุทุงุช"],
        a: 2 // ุงูุงูุชูุงู ุนูู ุทูู ุฎุท ุงูุจุตุฑ (Line of Sight) ูุชูุชุตุฑ ุนูู ูุณุงูุงุช ูุตูุฑุฉ
    }
];

// ********** ุงููุชุบูุฑุงุช **********
let maze = document.getElementById("maze");
let speed = 1.5;
let keys = {};
let currentQuestion = null;
let currentRoundQuestions = [];
let questionNodes = [];
let roundCounter = 1;
let remainingQuestions = [...allQuestions];
let roundSize = 10;
let answeredCorrectlyFirstTime = new Set();
let isMoving = true; // ููุชุญูู ูู ุญุฑูุฉ ุงูุฏูุฏุฉ

// ุงูุฏูุฏุฉ
let snake = [];
let snakeSegments = [];
let direction = {x: 1, y: 0}; // ุงูุงุชุฌุงู ุงูุงูุชุฑุงุถู: ูููู
let segmentDistance = 25; // ุงููุณุงูุฉ ุจูู ูู ููุทุฉ

const correctSound = new Audio('../media/correct.mp3');
const wrongSound = new Audio('../media/wrong.mp3');
const winSound = new Audio('../media/win.mp3');

function getRandomColor(){const letters='0123456789ABCDEF';let color='#';for(let i=0;i<6;i++)color+=letters[Math.floor(Math.random()*16)];return color;}
function shuffle(array){for(let i=array.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[array[i],array[j]]=[array[j],array[i]];}return array;}

// ********** ุฅูุดุงุก ุงูุฏูุฏุฉ **********
function createSnake() {
    // ูุณุญ ุงูุฏูุฏุฉ ุงููุฏููุฉ
    snake = [];
    
    // ุญุณุงุจ ุงููุฑูุฒ ุจูุงุกู ุนูู ุญุฌู ุงููุชุงูุฉ ุงูุญุงูู
    let centerX = maze.offsetWidth / 2;
    let centerY = maze.offsetHeight / 2;
    
    // ุฅูุดุงุก 3 ููุงุท ูู ุงูุจุฏุงูุฉ
    for(let i = 0; i < 3; i++) {
        snake.push({x: centerX, y: centerY + (i * segmentDistance)});
    }
    renderSnake();
}

function renderSnake() {
    // ุญุฐู ุงูููุงุท ุงููุฏููุฉ
    snakeSegments.forEach(seg => seg.remove());
    snakeSegments = [];
    
    // ุฑุณู ุงูุฏูุฏุฉ
    snake.forEach((segment, index) => {
        let seg = document.createElement('div');
        seg.className = 'snake-segment';
        if(index === 0) {
            seg.classList.add('snake-head');
            // ุงูุฑุฃุณ ุจุฏูู ุฑูู
        } else {
            // ุจุงูู ุงูุฌุณู ุนููู ุฃุฑูุงู
            seg.textContent = index;
        }
        seg.style.left = segment.x + 'px';
        seg.style.top = segment.y + 'px';
        
        maze.appendChild(seg);
        snakeSegments.push(seg);
    });
    
    updateSnakeLength();
}

function growSnake() {
    // ุฅุถุงูุฉ ููุทุฉ ุฌุฏูุฏุฉ ูู ุขุฎุฑ ุงูุฏูุฏุฉ
    let tail = snake[snake.length - 1];
    let beforeTail = snake[snake.length - 2];
    
    // ุญุณุงุจ ุงุชุฌุงู ุงูููุทุฉ ุงูุฌุฏูุฏุฉ
    let dx = tail.x - beforeTail.x;
    let dy = tail.y - beforeTail.y;
    let distance = Math.sqrt(dx * dx + dy * dy);
    
    if(distance > 0) {
        let ratio = segmentDistance / distance;
        snake.push({
            x: tail.x + dx * ratio,
            y: tail.y + dy * ratio
        });
    } else {
        snake.push({x: tail.x, y: tail.y + segmentDistance});
    }
    renderSnake();
}

function shrinkSnake() {
    // ุชูุตูุฑ ุงูุฏูุฏุฉ (ุญุฐู ุขุฎุฑ ููุทุฉ)
    if(snake.length > 2) { // ูุญุงูุธ ุนูู ููุทุชูู ุนูู ุงูุฃูู
        snake.pop();
        renderSnake();
    }
}

function updateSnakeLength() {
    document.getElementById('snakeLength').textContent = `ุทูู ุงูุฏูุฏุฉ: ${snake.length}`;
}

// ********** ุฅูุดุงุก ุงูููุฑ **********
function createNodes(questions){
    questionNodes.forEach(n=>n.remove());
    questionNodes=[];
    questions.forEach((q)=>{
        addNode(q);
    });
    updateRoundInfo();
}

function addNode(question){
    let node = document.createElement('div');
    node.className='q-node';
    node.dataset.question=question.q;
    let nodeNumber = questionNodes.length + 1; // ุฑูู ุงููุฑุฉ (1ุ 2ุ 3ุ ...)
    node.textContent = nodeNumber;
    
    // ********** ุงูููุทูุฉ ุงููุนุฏูุฉ ูุชุฑุชูุจ ุงูููุฑ **********
    let cols = 3; // ุนุฏุฏ ุงูุฃุนูุฏุฉ ูู ุงููุชุงูุฉ
    let rows = Math.ceil(currentRoundQuestions.length / cols); // ุนุฏุฏ ุงูุตููู ุงููุญุณูุจ
    
    let mazeWidth = maze.offsetWidth;
    let mazeHeight = maze.offsetHeight;
    let nodeSize = 50; // ุญุฌู ุงููุฑุฉ (50px ููุง ูู CSS)
    let margin = 40; // ูุงูุด ูุชุฑู ูุณุงูุฉ ุนู ุงูุญูุงู

    // ุญุณุงุจ ุงููุณุงูุงุช ุจุงูุชุณุงูู
    let stepX = (mazeWidth - 2 * margin) / (cols - 1 || 1);
    let stepY = (mazeHeight - 2 * margin) / (rows - 1 || 1);

    // ุญุณุงุจ ูููุน ุงููุฑุฉ ุงูุญุงููุฉ (ุงูุฑูู ููุซู ุชุฑุชูุจูุง)
    let colIndex = (nodeNumber - 1) % cols;
    let rowIndex = Math.floor((nodeNumber - 1) / cols);

    let x = margin + (colIndex * stepX) - (nodeSize / 2);
    let y = margin + (rowIndex * stepY) - (nodeSize / 2);

    // ุงูุชุญูู ูู ุฃู ุงููููุน ุถูู ุงูุญุฏูุฏ
    x = Math.max(margin, Math.min(x, mazeWidth - margin - nodeSize));
    y = Math.max(margin, Math.min(y, mazeHeight - margin - nodeSize));
    
    // ********** ููุงูุฉ ุงูููุทูุฉ ุงููุนุฏูุฉ **********
    
    node.style.left = x+'px';
    node.style.top = y+'px';
    node.style.background = getRandomColor();
    maze.appendChild(node);
    questionNodes.push(node);
}
// ********** ุนุฑุถ ุงูุณุคุงู **********
function showQuestion(node){
    if(currentQuestion!==null) return;
    currentQuestion = node;
    isMoving = false; // ุชููู ุงูุฏูุฏุฉ
    
    const qb = document.getElementById("questionBox");
    qb.style.display="block";

    const qData = currentRoundQuestions.find(q=>q.q===node.dataset.question);
    document.getElementById("qText").textContent = qData.q;

    const ch = document.getElementById("choices");
    ch.innerHTML="";
    let choices = qData.c.map((txt,index)=>({txt,index}));
    choices = shuffle(choices);

    choices.forEach(choice=>{
        let d=document.createElement("div");
        d.className="choice";
        d.textContent=choice.txt;
        d.onclick=()=>{
            if(choice.index===qData.a){
                correctSound.play();

                // ุฃูู ูุฑุฉ ุตุญูุญุฉ - ุชุทูู ุงูุฏูุฏุฉ!
                if(!answeredCorrectlyFirstTime.has(qData.q)){
                    answeredCorrectlyFirstTime.add(qData.q);
                    document.getElementById("answeredList").innerHTML+=
                        `<div class="answered">${qData.q} - ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ: ${qData.c[qData.a]}</div>`;
                    remainingQuestions = remainingQuestions.filter(q=>q.q!==qData.q);
                    
                    // ุชุทูู ุงูุฏูุฏุฉ
                    growSnake();
                }

                // ุฅุฒุงูุฉ ูู ุงูููุฑ ุงููุฑุชุจุทุฉ ุจุงูุณุคุงู
                questionNodes.filter(n=>n.dataset.question===qData.q)
                             .forEach(n=>n.remove());
                questionNodes = questionNodes.filter(n=>n.dataset.question!==qData.q);

                currentQuestion = null;
                isMoving = true; // ุงุณุชุฆูุงู ุงูุญุฑูุฉ
                qb.style.display="none";
                updateRoundInfo();

                if(questionNodes.length===0) startNextRound();
            } else {
                wrongSound.play();
                
                // ุชูุตูุฑ ุงูุฏูุฏุฉ
                shrinkSnake();
                
                alert("ุฎุทุฃุ ุญุงูู ูุฑุฉ ุฃุฎุฑู!");
                // ุฅุฒุงูุฉ ุงููุฑุฉ ุงูุญุงููุฉ
                node.remove();
                questionNodes = questionNodes.filter(n=>n!==node);
                // ุฅุถุงูุฉ ูุฑุฉ ุฌุฏูุฏุฉ ูููุณ ุงูุณุคุงู
                addNode(qData);
                currentQuestion = null;
                isMoving = true; // ุงุณุชุฆูุงู ุงูุญุฑูุฉ
                qb.style.display="none";
                updateRoundInfo();
            }
        };
        ch.appendChild(d);
    });
}

// ********** ุงูุชุญูู ูู ุงููุงุนุจ **********
function checkQuestionNodes(){
    if(currentQuestion!==null) return;
    let head = snake[0];
    questionNodes.forEach(node=>{
        let nx=node.offsetLeft, ny=node.offsetTop;
        if(Math.abs(head.x-nx)<40 && Math.abs(head.y-ny)<40){ 
            showQuestion(node); 
        }
    });
}

// ********** ุญุฑูุฉ ุงูุฏูุฏุฉ **********
// ููููุจููุชุฑ: ุงูุฃุณูู
document.addEventListener('keydown', e=> {
    e.preventDefault();
    if(e.key === 'ArrowUp' && direction.y === 0) {
        direction = {x: 0, y: -1};
    } else if(e.key === 'ArrowDown' && direction.y === 0) {
        direction = {x: 0, y: 1};
    } else if(e.key === 'ArrowLeft' && direction.x === 0) {
        direction = {x: -1, y: 0};
    } else if(e.key === 'ArrowRight' && direction.x === 0) {
        direction = {x: 1, y: 0};
    }
});

// ููููุจุงูู: ุงูุณุญุจ (Swipe)
let touchStartX = 0;
let touchStartY = 0;
let touchEndX = 0;
let touchEndY = 0;

document.addEventListener('touchstart', e => {
    touchStartX = e.changedTouches[0].screenX;
    touchStartY = e.changedTouches[0].screenY;
}, {passive: true});

document.addEventListener('touchend', e => {
    touchEndX = e.changedTouches[0].screenX;
    touchEndY = e.changedTouches[0].screenY;
    handleSwipe();
}, {passive: true});

function handleSwipe() {
    let diffX = touchEndX - touchStartX;
    let diffY = touchEndY - touchStartY;
    
    // ุชุญุฏูุฏ ุงูุงุชุฌุงู ุงูุฃููู (ุฃููู ุฃู ุฑุฃุณู)
    if(Math.abs(diffX) > Math.abs(diffY)) {
        // ุญุฑูุฉ ุฃูููุฉ
        if(diffX > 20 && direction.x === 0) {
            // ุณุญุจ ูููู
            direction = {x: 1, y: 0};
        } else if(diffX < -20 && direction.x === 0) {
            // ุณุญุจ ุดูุงู
            direction = {x: -1, y: 0};
        }
    } else {
        // ุญุฑูุฉ ุฑุฃุณูุฉ
        if(diffY > 20 && direction.y === 0) {
            // ุณุญุจ ุชุญุช
            direction = {x: 0, y: 1};
        } else if(diffY < -20 && direction.y === 0) {
            // ุณุญุจ ููู
            direction = {x: 0, y: -1};
        }
    }
}

function moveSnake(){
    if(!isMoving) {
        requestAnimationFrame(moveSnake);
        return;
    }
    
    // ุชุญุฑูู ุงูุฑุฃุณ ูู ุงูุงุชุฌุงู ุงูุญุงูู
    let head = snake[0];
    let newX = head.x + (direction.x * speed);
    let newY = head.y + (direction.y * speed);
    
    // ุญุฏูุฏ ุงูุดุงุดุฉ - ุงุฑุชุฏุงุฏ (ูุน ุฃุฎุฐ ุญุฌู ุงูููุทุฉ ูู ุงูุงุนุชุจุงุฑ)
    let segmentSize = parseFloat(getComputedStyle(document.querySelector('.snake-segment') || document.createElement('div')).width) || 20;
    
    if(newX < segmentSize/2 || newX > maze.offsetWidth - segmentSize/2) {
        direction.x = -direction.x;
        newX = Math.max(segmentSize/2, Math.min(maze.offsetWidth - segmentSize/2, newX));
    }
    if(newY < segmentSize/2 || newY > maze.offsetHeight - segmentSize/2) {
        direction.y = -direction.y;
        newY = Math.max(segmentSize/2, Math.min(maze.offsetHeight - segmentSize/2, newY));
    }
    
    // ุชุญุฑูู ุงูุฑุฃุณ
    snake[0] = {x: newX, y: newY};
    
    // ุชุญุฏูุซ ููุงูุน ุจุงูู ุงูููุงุท ูุชุชุจุน ุงูุฑุฃุณ ุจูุณุงูุงุช ุซุงุจุชุฉ
    for(let i = 1; i < snake.length; i++) {
        let prev = snake[i - 1];
        let curr = snake[i];
        
        let dx = prev.x - curr.x;
        let dy = prev.y - curr.y;
        let distance = Math.sqrt(dx * dx + dy * dy);
        
        if(distance > 0) {
            let ratio = segmentDistance / distance;
            snake[i] = {
                x: prev.x - dx * ratio,
                y: prev.y - dy * ratio
            };
        }
    }
    
    renderSnake();
    checkQuestionNodes();
    requestAnimationFrame(moveSnake);
}

// ********** ุจุฏุก ุงูุฌููุฉ ุงูุชุงููุฉ **********
function startNextRound(){
    if(remainingQuestions.length===0){
        document.getElementById('winScreen').style.display='flex';
        winSound.play();
        return;
    }

    currentRoundQuestions=[];
    
    // ุงูุชุนุฏูู ููุง: ุจุฏูุงู ูู ุงูุฎูุทุ ูุณุชุฎุฏู ุงูุฌุฒุก ุงูุฃูู ูู ุงูุฃุณุฆูุฉ ุงููุชุจููุฉ ุจุงูุชุฑุชูุจ
    // let shuffled = shuffle([...remainingQuestions]); // <== ุชู ุฅูุบุงุก ุงูุฎูุท
    
    // ุงุณุชุฎุฏุงู ุงูุฃุณุฆูุฉ ุงููุชุจููุฉ ุจุงูุชุฑุชูุจ
    let questionsToUse = [...remainingQuestions];
    
    for(let i=0; i<Math.min(roundSize, questionsToUse.length); i++){
        // ุงุณุชุฎุฏุงู ุงูุฃุณุฆูุฉ ุงููุฑุชุจุฉ
        currentRoundQuestions.push({...questionsToUse[i]}); 
    }

    // ุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุฏูุฏุฉ ูู ุฌุฏูุฏ ุจุญุฌููุง ุงูุฃุตูู
    createSnake();
    
    // ุงูุชุนุฏูู ููุง: ููุฑุฑ ุงูุฃุณุฆูุฉ ุงููุฑุชุจุฉ ุงูุชู ุชู ุงุฎุชูุงุฑูุง ููุฌููุฉ
    createNodes(currentRoundQuestions); 
    roundCounter++;
}

// ********** ุชุญุฏูุซ ุงููุนูููุงุช **********
function updateRoundInfo(){
    let answeredCount = currentRoundQuestions.filter(q=>answeredCorrectlyFirstTime.has(q.q)).length;
    document.getElementById("roundInfo").textContent = `ุงูุฌููุฉ: ${roundCounter}`;
    document.getElementById("questionInfo").textContent = `ุงูุณุคุงู: ${answeredCount} / ${currentRoundQuestions.length}`;
}

// ********** ุจุฏุก ุงููุนุจุฉ **********
createSnake();
startNextRound();
moveSnake();
</script>
</body>
</html>
